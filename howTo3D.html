<!DOCTYPE html>
<html>
<head>
	<title>How To 3D</title>
	<style>
	#mainPanel {
		position: absolute;
		width: 70%;
		left: 15%;
		padding: 0;
	}
	
	#titleBar {
		color: #BB3322;
		width: 90%;
		font-variant: small-caps;
		font-style: italic;
		font-size: 45px;
		font-size: 5vw;
		padding-left: 5%;
		padding-right: 5%;
		padding-top: 3%;
		padding-bottom:1%;
	}
	
	#content {
		width: 96%;
		vertical-align: top;
		padding: 2%;
	}
	
	#contentTable {
		width: 100%;
	}
	
	#graph {
		width: 100%;
		border: 2px solid #BB3322;
		border-radius: 5px;
	}
	
	.note {
		width: 95%;
		padding: 2.5%;
		margin-top: 5%;
		border: 1px solid #DDC022;
		background: #FFF4AB;
		color: #997000;
	}
	
	.navBarCol {
		width: 33%;
		background: #BB3322;
	}
	
	.navBut {
		font-variant: small-caps;
		font-style: italic;
		font-size: 25px;
		font-size: 2vw;
		width: 100%;
		padding-top: 5%;
		padding-bottom: 5%;
		-webkit-transition-duration: 0.4s; /* Safari */
		transition-duration: 0.4s;
		background: #BB3322;
		color: #FFFDF9;
		border: none;
		border-radius: 0px;
	}
	
	.navBut:hover {
		margin-left: -10%;
		width: 120%;
		border-radius: 15px;
		box-shadow: 5px 10px 18px #661100
	}
	
	#navBar {
		width: 100%;
		background: #BB3322;
	}
	
	#navBarBoat {
		position: fixed;
		left: 0%;
		width: 12%;
		top: 5%;
	}
	
	body {
		background: linear-gradient(to right, #FDF3DF, #FFFFFF, #FDF3DF);
		font-family: Verdana;
		color: #BB3322;
		overflow: scroll;
	}
	
	sectionTitle {
		font-weight: bold;
		font-variant: small-caps;
		font-size: 25px;
	}
	
	table {
		width: 100%;
	}
	
	img {
		margin: 5%;
		width: 85%;
		border: 2px solid #BB3322;
		border-radius: 5px;
		max-width: 700px;
	}
	
	</style>
	
	<!--Scripts I made-->
	<script src="VectorSpace.js"></script>
	<script src="Block.js"></script>
	<script src="Surface.js"></script>
	<script src="Thing.js"></script>
	<script src="Graphics.js"></script>
	<script src="Alterations.js"></script>
	<script src='jquery.js'></script>
	
</head>
<body>

	<!-- Everything on the page fits on the mainPanel (except for the floating nav bar) -->
	<div id='mainPanel'>
		<p id='top'></p>
		<!-- Title bar -->
		<div id='titleBar'>
			<table>
				<tr>
					<td width='60%'>
						How to make 3D graphics from scratch
					</td>
					<td width='40%'>
						<canvas id='graph'></canvas>
					</td>
				</tr>
			</table>
		</div>
		
		<!-- Middle stuff -->
		<div id='content'>
			Below is a brief description of the algorithms I made to power this site's 3D
			graphics.
			<br>
			<br>
			<br>
			<sectionTitle>Introduction</sectionTitle>
			<br>
			<br>
			To create convincing 3D graphics, we want to create an intuitive 3D space that is easy
			to describe mathematically. After that, we will create a set of algorithms which takes
			that description of a 3D space and converts it into a 2D image to display on the screen.
			<br>
			<br>
			<br>
			<sectionTitle>The Coordinate System</sectionTitle>
			<br>
			<br>
			One of the easiest ways to describe our 3D space is with Cartesian coordinates. Let us define
			the following coordinate system.
			<br>
			<br>
			<center><img src='./coordinates.png' alt='coordinate system image'></img></center>
			<br>
			<br>
			<sectionTitle>From 3D space to a 2D screen</sectionTitle>
			<br>
			<br>
			The coordinate system above is particularly conducive to mapping onto a 2D screen. Imagine
			that the screen is a window through which we are looking at our 3D space.
			<br>
			<br>
			<center><img src='./visionScreen.png' alt='coordinate system image'></img></center>
			<br>
			<br>
			If we make a good guess for the portion of our angular field of view that is taken up by the 
			screen (usually about 90&deg; in the vertical direction)
			, we can determine a "visible plane" which is at a convenient location (in this case,
			the plane <i>y</i> = 0).
			<br>
			<br>
			<center><img src='./visionPlane.png' alt='coordinate system image'></img></center>
			<br>
			<br>
			We know the absolute size of this visible plane (from our field of view choice). If we project
			a visible point onto the plane, we can determine its relative position on the visible plane
			as percentages of the width and the height of the visible plane. These percentages indicate
			where a point should appear on our screen, relative to its total width and height.
			<br>
			<br>
			<center><img src='./visionCone.png' alt='coordinate system image'></center>
			<br>
			<br>
			If we have a point in our 3D space at {<i>x</i>, <i>y</i>, <i>z</i>} we can calculate the 
			<i>x<sub>vp</sub></i> and <i>z<sub>vp</sub></i> coordinates of the point projected onto
			the vision plane as follows:
			<br>
			<br>
			<br>
			<center>
				<table style='width: 40%; max-width: 200px'>
					<tr>
						<td rowspan='2' style='width: 50%; text-align: right;'>
							<i>x<sub>vp</sub></i> =
						</td>
						<td style='border-bottom: 1px solid #BB3322; width: 50%;'>
							<center><i>x</i> <i>y<sub>ob</sub></i></center>
						</td>
					</tr>
						<td>
							<center>(<i>y<sub>ob</sub></i> - <i>y</i>)</center>
						</td>
					<tr>
					</tr>
				</table>
				<br>
				<table style='width: 40%; max-width: 200px;'>
					<tr>
						<td rowspan='2' style='width: 50%; text-align: right;'>
							<i>z<sub>vp</sub></i> =
						</td>
						<td style='border-bottom: 1px solid #BB3322; width: 50%;'>
							<center><i>z</i> <i>y<sub>ob</sub></i></center>
						</td>
					</tr>
						<td>
							<center>(<i>y<sub>ob</sub></i> - <i>y</i>)</center>
						</td>
					<tr>
					</tr>
				</table>
			</center>
			<br>
			<br>
			<i>y<sub>ob</sub></i> is the <i>y</i> coordinate of the observer.
			The max visible <i>x</i> and <i>z</i> coordinates on our vision plane (<i>x<sub>max</sub></i>,
			and <i>z<sub>max</sub></i>, respectively) are given by the following.
			<br>
			<br>
			<br>
			<center>
				<table width='100%'>
					<tr>
						<td style='text-align: center'>
							<i>x<sub>max</sub></i> = <i>y<sub>ob</sub></i> sin(<i>&theta;<sub>horizontal field of view</sub></i> / 2)
						</td>
					</tr>
						<td style='text-align: center; padding-top: 5%;'>
							<i>z<sub>max</sub></i> = <i>y<sub>ob</sub></i> sin(<i>&theta;<sub>vertical field of view</sub></i> / 2)
						</td>
					<tr>
					</tr>
				</table>
			</center>
			<br>
			<br>
			Finally, we can determine the percentages
			of screen width (<i>X</i>, where <i>X</i> = 0 corresponds to the left end of the screen) and
			height (<i>Y</i>, where <i>Y</i> = 0 corresponds to the top of the screen) as follows.
			<br>
			<br>
			<center>
				<table style='width: 100%; max-width: 400px;'>
					<tr>
						<td rowspan='2' style='width: 30%; text-align: right;'>
							<i>X</i> =
						</td>
						<td style='border-bottom: 1px solid #BB3322; width: 30%; max-width: 200px;'>
							<center><i>x<sub>vp</sub></i></center>
						</td>
						<td rowspan='2' style='width: 200px;'>
							+ 0.5
						</td>
					</tr>
						<td>
							<center>2 <i>x<sub>max</sub></i></center>
						</td>
					<tr>
					</tr>
				</table>
				<br>
				<table style='width: 100%; max-width: 400px;'>
					<tr>
						<td rowspan='2' style='width: 30%; text-align: right;'>
							<i>Y</i> =
						</td>
						<td style='border-bottom: 1px solid #BB3322; width: 30%; max-width: 200px;'>
							<center>-<i>z<sub>vp</sub></i></center>
						</td>
						<td rowspan='2' style='width: 200px;'>
							+ 0.5
						</td>
					</tr>
						<td>
							<center>2 <i>z<sub>max</sub></i></center>
						</td>
					<tr>
					</tr>
				</table>
			</center>
			<br>
			<br>
			<sectionTitle>That's It! (for points)</sectionTitle>
			<br>
			<br>
			That's all it takes to plot points from a 3D environment to a 2D screen. However, if you want
			to display more sophisticated objects (like shapes and surfaces) there's a bit more work to do.
			<br>
			<br>
			Details on shapes and surfaces are coming here soon.
		</div>
		
		<!-- Nav bar at bottom -->

	</div>
	
	<div id='navBarBoat'>
	
		<table id='navBar'>
			<tr>
				<td class='navBarCol'>
					<button class='navBut' id='homeBut'>Home</button>
				</td>
			</tr>
			<tr>
				<td class='navBarCol'>
					<button class='navBut' id='resumeBut'>Resume</button>
				</td>
			</tr>
			<tr>
				<td class='navBarCol'>
					<button class='navBut' id='projectsBut'>Projects</button>
				</td>
			</tr>
			<tr>
				<td class='navBarCol'>
					<button class='navBut' id='contactBut'>Contact</button>
				</td>
			</tr>
			
		</table>
	
	</div>
	
	<script>
	
		//Global lists
		var things = [];	//The 3D environment paints surfaces. "Things" are groups of related surfaces (e.g. a thing could be a cube with all the faces as surfaces).
		var textBlocks = [];
		var allSurfaces = [];	//When it comes time to paint all the surfaces in the 3D environment, "things" are dissolved and all surfaces are dumped and sorted into this array.
		var alterations = [];	//This object registers an instance of a "thing" which is to undergo a change during mouseover (e.g. menu buttons sliding on mouseover).
		
		//viewport properties
		var yob = 10;	//The view created in this page will be from point <0, yob, 0> in the <0, -1, 0> direction. Therefore, this value influences the apperance of object sizes and perspective
		var YFOVangle = Math.PI / 4;	//This is the angular width of the web page's field of view, in radians. A computer screen takes up about PI / 4 of your vertical field of view, so this is
										//a good YFOVangle for the 3D effects in browser to look natural and realistic.
		var XFOVangle = Math.PI / 4 * window.innerWidth / window.innerHeight;	//This is the angular height of the web page's field of view, in radians. This is determined by our choice for
		var c = document.getElementById('graph');
		var ctx = c.getContext('2d');
		
		//--------------------------------------------------------------------------
		// Objects for animation
		//--------------------------------------------------------------------------
		
		origin = [-0.5, 6, -0.5];	
		vertices = generateBlockVertices(origin, 1, 1, 1);	
		things.push(createThing(generateBlockSurfaces(vertices, "#BB3322"), "backBlock1"));	
		
		//--------------------------------------------------------------------------
		// FUNCTIONS
		//--------------------------------------------------------------------------
		$(document).ready(function(){
			fitCanvas();
			$(window).resize(function() {fitCanvas();});
			homeAnimation();
		});
		//--------------------------------------------------------------------------
		function fitCanvas(){
			c.width  = c.offsetWidth;
			c.height = c.width;
			XFOVangle = Math.PI / 4;
			YFOVangle = Math.PI / 4 / parseFloat(c.width) * parseFloat(c.height);
			repaint("#FDF9EF");
		}
		//--------------------------------------------------------------------------
		// Animation
		//--------------------------------------------------------------------------
		//Record of time of last repaint
		var lastRepaintTime = 0;
		var minRepaintInterval = 50; //in ms
		var counter = 0;
		var stepLimit = 200;
		var delay = 100;
		var pauseBetweenAnimations = 1000;
		
		var translationDirection0 = [0, 5, 1];
		var rotationAxisPoint0 = [-0.5, 6, -0.5];
		var rotationAxisDirection0 = [1, 1, 1];
		
		function homeAnimation(){
			
			things[0] = translateAndRotateThing(things[0], translationDirection0, 0, rotationAxisPoint0, rotationAxisDirection0, 2 * Math.PI / stepLimit);
				
			requestRepaint('#FDFCFA');
			
			setTimeout(homeAnimation, delay);
			
		}
		//--------------------------------------------------------------------------
		// Links for buttons
		//--------------------------------------------------------------------------
		$('#homeBut').click(function(){window.location.replace("./index.html");});
		$('#resumeBut').click(function(){window.location.replace("./resume2.html");});
		$('#contactBut').click(function(){window.location.replace("./contact2.html");});
		$('#projectsBut').click(function(){window.location.replace("./projects2.html");});
		//--------------------------------------------------------------------------
		//--------------------------------------------------------------------------
		//--------------------------------------------------------------------------
		//--------------------------------------------------------------------------
	
	</script>
</body>
</html>